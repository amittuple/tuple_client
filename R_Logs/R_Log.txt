
Attaching package: ‘data.table’

The following object is masked _by_ ‘.GlobalEnv’:

    .N

Loading required package: methods
Loading required package: DBI
Loading required package: hypergeo

Attaching package: ‘BTYD’

The following object is masked _by_ ‘.GlobalEnv’:

    dc.SplitUpElogForRepeatTrans


Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

------------------------------------------------------------------------------
data.table + dplyr code now lives in dtplyr.
Please library(dtplyr)!
------------------------------------------------------------------------------

Attaching package: ‘dplyr’

The following objects are masked from ‘package:data.table’:

    between, first, last

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union


Attaching package: ‘lubridate’

The following objects are masked from ‘package:data.table’:

    hour, isoweek, mday, minute, month, quarter, second, wday, week,
    yday, year

The following object is masked from ‘package:base’:

    date

Loading required package: statmod

----------------------------------------------------------------------

Your next step is to start H2O:
    > h2o.init()

For H2O package documentation, ask for help:
    > ??h2o

After starting H2O, you can use the Web UI at http://localhost:54321
For more information visit http://docs.h2o.ai

----------------------------------------------------------------------


Attaching package: ‘h2o’

The following objects are masked from ‘package:lubridate’:

    day, hour, month, week, year

The following objects are masked from ‘package:data.table’:

    hour, month, week, year

The following objects are masked from ‘package:stats’:

    cor, sd, var

The following objects are masked from ‘package:base’:

    ||, &&, %*%, apply, as.factor, as.numeric, colnames, colnames<-,
    ifelse, %in%, is.character, is.factor, is.numeric, log, log10,
    log1p, log2, round, signif, trunc

Type 'citation("pROC")' for a citation.

Attaching package: ‘pROC’

The following object is masked from ‘package:h2o’:

    var

The following objects are masked from ‘package:stats’:

    cov, smooth, var

Loading required package: lattice
Loading required package: ggplot2
Loading required package: gplots

Attaching package: ‘gplots’

The following object is masked from ‘package:stats’:

    lowess

Warning message:
In library() : library ‘/usr/lib/R/site-library’ contains no packages
[1] "utils.R"
[1] "yml.R"
[1] "Connection.R"
[1] "CLTV_Final_trans"
                                product_id receipt_id revenue
1: com.gopaktor.subscription.v4.premium.1m    1950705   28.98
2: com.gopaktor.subscription.v4.premium.1m    1388808   28.98
3: com.gopaktor.subscription.v4.premium.1m    1409469   28.98
4: com.gopaktor.subscription.v4.premium.1m    1853800   28.98
5: com.gopaktor.subscription.v4.premium.1m    1810983   28.98
6: com.gopaktor.subscription.v4.premium.1m    1358694   28.98
             timestamp renewal cust_id insider platform quantity
1: 2016-09-07 02:25:39       0 6093827       0  android        0
2: 2016-07-07 17:54:01       1  110380       0  android        0
3: 2016-06-10 17:54:00       1  131057       0  android        0
4: 2016-07-27 18:53:07       0  133977       0  android        0
5: 2016-07-06 10:18:42       0  171879       0  android        0
6: 2016-07-04 04:36:00       1  194181       0  android        0
   cust_id       date sales
1: 6093827 2016-09-07 28.98
2:  110380 2016-07-07 28.98
3:  131057 2016-06-10 28.98
4:  133977 2016-07-27 28.98
5:  171879 2016-07-06 28.98
6:  194181 2016-07-04 28.98
    cust        ltd       sltd  revenue
1:  9880 2016-09-25       <NA> 113.0000
2:  9912 2016-06-07       <NA>  28.9800
3: 10319 2016-08-19 2016-07-19  86.9400
4: 10939 2016-09-12 2016-08-12 115.9200
5: 11279 2016-06-10       <NA>  28.9800
6: 13052 2016-09-06       <NA>  73.8913
# A tibble: 6 × 3
   diff  cust        rev
  <dbl> <int>      <dbl>
1     0   665 34777.8720
2     1    12  1022.5200
3     2     4   251.8013
4     3     2   132.8513
5     4     2   132.8513
6     5     1   352.9100
      cust     cltv
 1:  10319 29.19784
 2: 105945 29.19784
 3:  10939 29.19784
 4: 110380 47.07039
 5: 118179 29.19784
 6: 131057 29.34184
 7: 133977 29.34184
 8: 186761 29.34184
 9: 187337 29.34184
10: 194181 29.19784
     cust  sales.x sales.y
1:  10319  86.9400      NA
2: 105945  86.9400      NA
3:  10939 115.9200   28.98
4: 110380 131.8513      NA
5:  11279  28.9800      NA
6: 116647  28.9800   28.98
     cust  sales.x  sales.y     cltv
 1:  9880 113.0000 113.0000  0.00000
 2:  9912  28.9800   0.0000  0.00000
 3: 10319  86.9400   0.0000 29.19784
 4: 10939 115.9200  28.9800 29.19784
 5: 11279  28.9800   0.0000  0.00000
 6: 13052  73.8913   0.0000  0.00000
 7: 13565  73.8913   0.0000  0.00000
 8: 16130  73.8913   0.0000  0.00000
 9: 17094  28.9800   0.0000  0.00000
10: 17916 113.0000   0.0000  0.00000
11: 18818  57.9600  28.9800  0.00000
12: 19939  28.9800   0.0000  0.00000
13: 22011 113.0000   0.0000  0.00000
14: 24776  73.8913   0.0000  0.00000
15: 24990  28.9800   0.0000  0.00000
16: 25936 115.9200  28.9800 29.19784
17: 28331 147.7826  73.8913  0.00000
18: 29054 113.0000   0.0000  0.00000
19: 29139  57.9600  28.9800  0.00000
20: 31468  28.9800   0.0000  0.00000
[1] "Churn_Trans"
                                product_id receipt_id revenue
1: com.gopaktor.subscription.v4.premium.1m    1950705   28.98
2: com.gopaktor.subscription.v4.premium.1m    1388808   28.98
3: com.gopaktor.subscription.v4.premium.1m    1409469   28.98
4: com.gopaktor.subscription.v4.premium.1m    1853800   28.98
5: com.gopaktor.subscription.v4.premium.1m    1810983   28.98
6: com.gopaktor.subscription.v4.premium.1m    1358694   28.98
             timestamp renewal cust_id insider platform quantity
1: 2016-09-07 02:25:39       0 6093827       0  android        0
2: 2016-07-07 17:54:01       1  110380       0  android        0
3: 2016-06-10 17:54:00       1  131057       0  android        0
4: 2016-07-27 18:53:07       0  133977       0  android        0
5: 2016-07-06 10:18:42       0  171879       0  android        0
6: 2016-07-04 04:36:00       1  194181       0  android        0
   cust_id       date sales
1: 6093827 2016-09-07 28.98
2:  110380 2016-07-07 28.98
3:  131057 2016-06-10 28.98
4:  133977 2016-07-27 28.98
5:  171879 2016-07-06 28.98
6:  194181 2016-07-04 28.98
    cust        ltd       sltd  revenue
1:  9880 2016-09-25       <NA> 113.0000
2:  9912 2016-06-07       <NA>  28.9800
3: 10319 2016-08-19 2016-07-19  86.9400
4: 10939 2016-09-12 2016-08-12 115.9200
5: 11279 2016-06-10       <NA>  28.9800
6: 13052 2016-09-06       <NA>  73.8913
# A tibble: 6 × 3
   diff  cust        rev
  <dbl> <int>      <dbl>
1     0   665 34777.8720
2     1    12  1022.5200
3     2     4   251.8013
4     3     2   132.8513
5     4     2   132.8513
6     5     1   352.9100
Source: local data frame [6 x 3]
Groups: cust [2]

    cust       date sales
   <chr>     <date> <dbl>
1  10319 2016-06-11 28.98
2  10319 2016-07-19 28.98
3  10319 2016-08-19 28.98
4 105945 2016-06-28 28.98
5 105945 2016-07-28 28.98
6 105945 2016-08-28 28.98
Started Creating Repeat Purchases
Finished Creating Repeat Purchases
...Completed Freq CBT
...Completed Freq CBT
Started making calibration period CBS...
Finished building CBS.
Started making calibration period CBS...
Finished building CBS.
Started making calibration period CBS...
Finished building CBS.
      x      t.x      T.cal
9912  0 0.000000 13.2857143
10319 2 9.857143 12.7142857
10939 2 8.714286 12.5714286
11279 0 0.000000 12.8571429
13052 0 0.000000  0.2857143
13565 0 0.000000 10.7142857
     cust pred.tran prob.alive
 1:  9912  1.295721  1.0000000
 2: 10319  3.174573  0.9999073
 3: 10939  3.187757  0.9998964
 4: 11279  1.311775  1.0000000
 5: 13052  2.060686  1.0000000
 6: 13565  1.398403  1.0000000
 7: 16130  1.947002  1.0000000
 8: 17094  1.469572  1.0000000
 9: 17916  1.743899  1.0000000
10: 18818  1.753526  1.0000000
    cust visits.x visits.y
1:  9880        1        1
2:  9912        1       NA
3: 10319        3       NA
4: 10939        4        1
5: 11279        1       NA
6: 13052        1       NA
      cust visits.x visits.y pred.tran prob.alive
 1:  10319        3        0         3  0.9999073
 2: 105945        3        0         3  0.9999181
 3:  10939        4        1         3  0.9998964
 4: 110380        3        0         3  0.9998989
 5:  11279        1        0         1  1.0000000
 6: 116647        1        1         0  0.0000000
 7: 118179        4        1         3  0.9999219
 8: 120829        1        0         1  1.0000000
 9: 120931        1        0         1  1.0000000
10: 124374        1        0         1  1.0000000
11:  13052        1        0         2  1.0000000
12: 131057        2        0         2  0.9998622
13: 131211        1        0         1  1.0000000
14: 133977        2        0         2  0.9999193
15:  13565        1        0         1  1.0000000
16: 136063        1        0         1  1.0000000
17: 140669        1        1         0  0.0000000
18:  16130        1        0         1  1.0000000
19:  17094        1        0         1  1.0000000
20: 171879        1        0         1  1.0000000
[1] "CLTV_Final_Trans_Score"
                                product_id receipt_id revenue
1: com.gopaktor.subscription.v4.premium.1m    1950705   28.98
2: com.gopaktor.subscription.v4.premium.1m    1388808   28.98
3: com.gopaktor.subscription.v4.premium.1m    1409469   28.98
4: com.gopaktor.subscription.v4.premium.1m    1853800   28.98
5: com.gopaktor.subscription.v4.premium.1m    1810983   28.98
6: com.gopaktor.subscription.v4.premium.1m    1358694   28.98
             timestamp renewal cust_id insider platform quantity
1: 2016-09-07 02:25:39       0 6093827       0  android        0
2: 2016-07-07 17:54:01       1  110380       0  android        0
3: 2016-06-10 17:54:00       1  131057       0  android        0
4: 2016-07-27 18:53:07       0  133977       0  android        0
5: 2016-07-06 10:18:42       0  171879       0  android        0
6: 2016-07-04 04:36:00       1  194181       0  android        0
   cust_id       date sales
1: 6093827 2016-09-07 28.98
2:  110380 2016-07-07 28.98
3:  131057 2016-06-10 28.98
4:  133977 2016-07-27 28.98
5:  171879 2016-07-06 28.98
6:  194181 2016-07-04 28.98
      cust     cltv
 1:  10319 29.57919
 2: 105945 29.57919
 3:  10939 29.40763
 4: 110380 47.59713
 5: 118179 29.40763
 6: 131057 29.98063
 7: 133977 29.98063
 8: 186761 29.98063
 9: 187337 29.98063
10:  18818 29.98063
     cust    sales     cltv
1:  10319  86.9400 29.57919
2: 105945  86.9400 29.57919
3:  10939 115.9200 29.40763
4: 110380 131.8513 47.59713
5:  11279  28.9800       NA
6: 116647  28.9800       NA
     cust    sales     cltv     value
1:  10319  86.9400 29.57919      High
2: 105945  86.9400 29.57919      High
3:  10939 115.9200 29.40763    Medium
4: 110380 131.8513 47.59713 Very High
5:  11279  28.9800  0.00000  Very Low
6: 116647  28.9800  0.00000  Very Low
     cust     cltv     value
1:  10319 29.57919      High
2: 105945 29.57919      High
3:  10939 29.40763    Medium
4: 110380 47.59713 Very High
5:  11279  0.00000  Very Low
6: 116647  0.00000  Very Low
Warning message:
In `[<-.data.table`(`*tmp*`, is.na(cltv.value$value), , value = list( :
  Coerced 'logical' RHS to 'character' to match the column's type. Either change the target column to 'logical' first (by creating a new 'logical' vector length 1042 (nrows of entire table) and assign that; i.e. 'replace' column), or coerce RHS to 'character' (e.g. 1L, NA_[real|integer]_, as.*, etc) to make your intent clear and for speed. Or, set the column type correctly up front when you create the table and stick to it, please.
[1] "Churn_Trans_Score"
                                product_id receipt_id revenue
1: com.gopaktor.subscription.v4.premium.1m    1950705   28.98
2: com.gopaktor.subscription.v4.premium.1m    1388808   28.98
3: com.gopaktor.subscription.v4.premium.1m    1409469   28.98
4: com.gopaktor.subscription.v4.premium.1m    1853800   28.98
5: com.gopaktor.subscription.v4.premium.1m    1810983   28.98
6: com.gopaktor.subscription.v4.premium.1m    1358694   28.98
             timestamp renewal cust_id insider platform quantity
1: 2016-09-07 02:25:39       0 6093827       0  android        0
2: 2016-07-07 17:54:01       1  110380       0  android        0
3: 2016-06-10 17:54:00       1  131057       0  android        0
4: 2016-07-27 18:53:07       0  133977       0  android        0
5: 2016-07-06 10:18:42       0  171879       0  android        0
6: 2016-07-04 04:36:00       1  194181       0  android        0
   cust_id       date sales
1: 6093827 2016-09-07 28.98
2:  110380 2016-07-07 28.98
3:  131057 2016-06-10 28.98
4:  133977 2016-07-27 28.98
5:  171879 2016-07-06 28.98
6:  194181 2016-07-04 28.98
Source: local data frame [6 x 3]
Groups: cust [2]

    cust       date sales
   <chr>     <date> <dbl>
1  10319 2016-06-11 28.98
2  10319 2016-07-19 28.98
3  10319 2016-08-19 28.98
4 105945 2016-06-28 28.98
5 105945 2016-07-28 28.98
6 105945 2016-08-28 28.98
Started Creating Repeat Purchases
Finished Creating Repeat Purchases
...Completed Freq CBT
...Completed Freq CBT
Started making calibration period CBS...
Finished building CBS.
      x      t.x     T.cal
9880  0 0.000000 0.4931507
9912  0 0.000000 4.1095890
10319 2 2.268493 3.9780822
10939 3 3.024658 3.9452055
11279 0 0.000000 4.0109589
13052 0 0.000000 1.1178082
     cust pred.tran prob.alive
 1:  9880  6.981070  1.0000000
 2:  9912  3.888112  1.0000000
 3: 10319 11.390470  0.9844724
 4: 10939 15.082654  0.9877083
 5: 11279  3.935667  1.0000000
 6: 13052  6.137718  1.0000000
 7: 13565  4.192027  1.0000000
 8: 16130  5.805508  1.0000000
 9: 17094  4.402315  1.0000000
10: 17916  5.210165  1.0000000
     cust visits pred.tran prob.alive churn engagement
1:  10319      3        11  0.9844724     0       High
2: 105945      3        12  0.9857957     0       High
3:  10939      4        15  0.9877083     0       High
4: 110380      3        11  0.9831583     0       High
5:  11279      1         3  1.0000000     0   Very Low
6: 116647      1         7  1.0000000     0     Medium
     cust churn engagement
1:  10319     0       High
2: 105945     0       High
3:  10939     0       High
4: 110380     0       High
5:  11279     0   Very Low
6: 116647     0     Medium
